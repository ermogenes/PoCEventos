CREATE STREAM pedidos (produtoId VARCHAR, quantidade INTEGER)
  WITH (kafka_topic='pedido', key_format='kafka', value_format='json', partitions=8, replicas=3);

CREATE STREAM notificacoes (origem VARCHAR, mensagem VARCHAR)
  WITH (kafka_topic='notificacao', key_format='kafka', value_format='json', partitions=8, replicas=3);

CREATE TABLE produtos_quantidade AS
  SELECT produtoid, SUM(quantidade) AS quantidade
  FROM pedidos GROUP BY produtoid;
